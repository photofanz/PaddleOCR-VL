# ğŸ“¦ å®‰è£æŒ‡å—

æœ¬æŒ‡å—å°‡å”åŠ©æ‚¨åœ¨ macOS (Apple Silicon) ä¸Šå®Œæ•´å®‰è£èˆ‡è¨­å®š PaddleOCR-VL Web Applicationã€‚

## ğŸ“‹ ç›®éŒ„

- [ç³»çµ±éœ€æ±‚](#ç³»çµ±éœ€æ±‚)
- [å®‰è£æ­¥é©Ÿ](#å®‰è£æ­¥é©Ÿ)
- [Gemini API è¨­å®š](#gemini-api-è¨­å®š)
- [é©—è­‰å®‰è£](#é©—è­‰å®‰è£)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## ç³»çµ±éœ€æ±‚

### ç¡¬é«”éœ€æ±‚

- **è™•ç†å™¨**ï¼šApple Silicon (M1/M2/M3) æˆ– Intel
  - æ¨è–¦ï¼šM3 Max æˆ–æ›´é«˜éšæ™¶ç‰‡
- **è¨˜æ†¶é«”**ï¼šæœ€å°‘ 8GB RAM
  - æ¨è–¦ï¼š16GB æˆ–æ›´å¤š
- **å„²å­˜ç©ºé–“**ï¼šæœ€å°‘ 5GB å¯ç”¨ç©ºé–“
  - åŒ…å«æ¨¡å‹æª”æ¡ˆèˆ‡ä¾è³´å¥—ä»¶

### è»Ÿé«”éœ€æ±‚

- **ä½œæ¥­ç³»çµ±**ï¼šmacOS 12.0 (Monterey) æˆ–æ›´æ–°ç‰ˆæœ¬
- **Python**ï¼š3.12 æˆ–æ›´æ–°ç‰ˆæœ¬
- **Conda**ï¼šå»ºè­°ä½¿ç”¨ Miniconda æˆ– Anaconda

---

## å®‰è£æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šå®‰è£ Condaï¼ˆå¦‚æœå°šæœªå®‰è£ï¼‰

å¦‚æœæ‚¨é‚„æ²’æœ‰å®‰è£ Condaï¼Œè«‹åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š

#### æ–¹æ³• 1ï¼šä½¿ç”¨ Homebrew

```bash
# å®‰è£ Homebrewï¼ˆå¦‚æœå°šæœªå®‰è£ï¼‰
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# å®‰è£ Miniconda
brew install --cask miniconda
```

#### æ–¹æ³• 2ï¼šæ‰‹å‹•å®‰è£

1. ä¸‹è¼‰ Minicondaï¼šhttps://docs.conda.io/en/latest/miniconda.html
2. é¸æ“‡ macOS Apple M1 (ARM64) ç‰ˆæœ¬
3. åŸ·è¡Œå®‰è£ç¨‹å¼

åˆå§‹åŒ– Condaï¼š

```bash
conda init zsh  # å¦‚æœä½¿ç”¨ zsh
# æˆ–
conda init bash  # å¦‚æœä½¿ç”¨ bash

# é‡æ–°è¼‰å…¥ shell
source ~/.zshrc  # æˆ– source ~/.bashrc
```

### æ­¥é©Ÿ 2ï¼šè¤‡è£½å°ˆæ¡ˆ

```bash
# è¤‡è£½å°ˆæ¡ˆ
git clone https://github.com/yourusername/PaddleOCR-VL.git
cd PaddleOCR-VL
```

### æ­¥é©Ÿ 3ï¼šå»ºç«‹ Conda ç’°å¢ƒ

```bash
# å»ºç«‹åç‚º paddle-ocr çš„ç’°å¢ƒï¼Œä½¿ç”¨ Python 3.12
conda create -n paddle-ocr python=3.12 -y

# å•Ÿç”¨ç’°å¢ƒ
conda activate paddle-ocr
```

**é‡è¦**ï¼šä¹‹å¾Œæ¯æ¬¡ä½¿ç”¨æ™‚éƒ½éœ€è¦å•Ÿç”¨æ­¤ç’°å¢ƒï¼š

```bash
conda activate paddle-ocr
```

### æ­¥é©Ÿ 4ï¼šå®‰è£ Python ä¾è³´

```bash
# å®‰è£æ‰€æœ‰ä¾è³´å¥—ä»¶
pip install -r requirements.txt
```

æ­¤æ­¥é©Ÿå°‡å®‰è£ï¼š

- **PaddlePaddle**ï¼šæ·±åº¦å­¸ç¿’æ¡†æ¶ï¼ˆåŒ…å« MPS æ”¯æ´ï¼‰
- **PaddleOCR**ï¼šOCR å·¥å…·å¥—ä»¶
- **FastAPI**ï¼šWeb æ¡†æ¶
- **PyMuPDF**ï¼šPDF è™•ç†
- **Google Generative AI**ï¼šGemini API å®¢æˆ¶ç«¯
- å…¶ä»–ç›¸é—œå¥—ä»¶

**æ³¨æ„**ï¼šé¦–æ¬¡å®‰è£å¯èƒ½éœ€è¦ 10-20 åˆ†é˜ï¼Œè¦–ç¶²è·¯é€Ÿåº¦è€Œå®šã€‚

### æ­¥é©Ÿ 5ï¼šè¨­å®šç’°å¢ƒè®Šæ•¸

```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp .env.example .env

# ä½¿ç”¨ç·¨è¼¯å™¨é–‹å•Ÿ .env æª”æ¡ˆ
nano .env  # æˆ–ä½¿ç”¨ vimã€VSCode ç­‰ç·¨è¼¯å™¨
```

ç·¨è¼¯ `.env` æª”æ¡ˆï¼Œè¨­å®šå¿…è¦çš„åƒæ•¸ï¼š

```ini
# Gemini API è¨­å®š
GEMINI_API_KEY=your_gemini_api_key_here  # æ›¿æ›ç‚ºæ‚¨çš„ API Key

# ä¼ºæœå™¨è¨­å®š
HOST=0.0.0.0
PORT=8000
DEBUG=True

# æª”æ¡ˆä¸Šå‚³è¨­å®š
MAX_UPLOAD_SIZE=52428800  # 50MB

# OCR è¨­å®š
DEFAULT_OCR_LANGUAGE=en
USE_GPU=True  # å•Ÿç”¨ MPS åŠ é€Ÿ

# Gemini è¨­å®š
GEMINI_MODEL=gemini-2.0-flash-exp
GEMINI_MAX_RETRIES=3
GEMINI_TIMEOUT=60
```

---

## Gemini API è¨­å®š

Gemini API ç”¨æ–¼æ™ºèƒ½æ–‡å­—è™•ç†ã€‚å¦‚æœæ‚¨ä¸éœ€è¦ AI è™•ç†åŠŸèƒ½ï¼Œå¯ä»¥è·³éæ­¤æ­¥é©Ÿã€‚

### å–å¾— Gemini API Key

1. å‰å¾€ [Google AI Studio](https://makersuite.google.com/app/apikey)
2. ç™»å…¥æ‚¨çš„ Google å¸³è™Ÿ
3. é»æ“Šã€ŒGet API Keyã€
4. å‰µå»ºæ–°çš„ API Key æˆ–ä½¿ç”¨ç¾æœ‰çš„
5. è¤‡è£½ API Key

### è¨­å®š API Key

æ–¹æ³• 1ï¼šåœ¨ `.env` æª”æ¡ˆä¸­è¨­å®š

```ini
GEMINI_API_KEY=AIza...your_actual_key
```

æ–¹æ³• 2ï¼šä½¿ç”¨ç’°å¢ƒè®Šæ•¸ï¼ˆè‡¨æ™‚ï¼‰

```bash
export GEMINI_API_KEY="AIza...your_actual_key"
```

### å…è²»é¡åº¦

Gemini API æä¾›æ…·æ…¨çš„å…è²»é¡åº¦ï¼š
- gemini-2.0-flash-exp: æ¯åˆ†é˜ 15 å€‹è«‹æ±‚
- gemini-pro: æ¯åˆ†é˜ 60 å€‹è«‹æ±‚

è©³æƒ…è«‹åƒé–±ï¼šhttps://ai.google.dev/pricing

---

## é©—è­‰å®‰è£

### é©—è­‰ PaddleOCR èˆ‡ MPS åŠ é€Ÿ

åŸ·è¡Œé©—è­‰è…³æœ¬ï¼š

```bash
python verify_paddle_mps.py
```

**é æœŸè¼¸å‡ºï¼š**

```
============================================================
  PaddleOCR MPS é©—è­‰è…³æœ¬
  Apple Silicon (M3 Max) æ¸¬è©¦
============================================================

============================================================
  1. æª¢æŸ¥ PaddleOCR å®‰è£
============================================================
âœ“ PaddleOCR å·²å®‰è£
  ç‰ˆæœ¬: 2.7.3

============================================================
  2. æª¢æŸ¥ PaddlePaddle å¾Œç«¯
============================================================
âœ“ PaddlePaddle å·²å®‰è£
  ç‰ˆæœ¬: 3.0.0
  â„¹ CUDA æ”¯æ´: å¦ï¼ˆmacOS ä½¿ç”¨ MPSï¼‰

============================================================
  3. å‰µå»ºæ¸¬è©¦åœ–åƒ
============================================================
âœ“ æ¸¬è©¦åœ–åƒå·²å‰µå»º: test_image.png
  å°ºå¯¸: (800, 400)

============================================================
  4. æ¸¬è©¦ OCR (CPU æ¨¡å¼, èªè¨€: en)
============================================================
æ­£åœ¨åˆå§‹åŒ– PaddleOCR (CPU)...
âœ“ åˆå§‹åŒ–å®Œæˆï¼Œè€—æ™‚ 2.34 ç§’
æ­£åœ¨è™•ç†åœ–åƒ: test_image.png
âœ“ OCR å®Œæˆï¼Œè€—æ™‚ 1.87 ç§’

è¾¨è­˜çµæœ:
  1. [0.98] PaddleOCR Test Image
  2. [0.96] Apple M3 Max
  3. [0.97] MacBook Pro 2024
  4. [0.95] This is a test for OCR recognition

============================================================
  5. æ¸¬è©¦ OCR (GPU/MPS æ¨¡å¼, èªè¨€: en)
============================================================
æ­£åœ¨åˆå§‹åŒ– PaddleOCR (GPU/MPS)...
âœ“ åˆå§‹åŒ–å®Œæˆï¼Œè€—æ™‚ 2.45 ç§’
  â„¹ åœ¨ macOS ä¸Šï¼Œuse_gpu=True æœƒå˜—è©¦ä½¿ç”¨ MPS åŠ é€Ÿ
æ­£åœ¨è™•ç†åœ–åƒ: test_image.png
âœ“ OCR å®Œæˆï¼Œè€—æ™‚ 0.95 ç§’

è¾¨è­˜çµæœ:
  1. [0.98] PaddleOCR Test Image
  2. [0.96] Apple M3 Max
  3. [0.97] MacBook Pro 2024
  4. [0.95] This is a test for OCR recognition

============================================================
æ¸¬è©¦ç¸½çµ
============================================================
CPU æ¨¡å¼: âœ“ æˆåŠŸ
  è™•ç†æ™‚é–“: 1.87 ç§’
GPU/MPS æ¨¡å¼: âœ“ æˆåŠŸ
  è™•ç†æ™‚é–“: 0.95 ç§’
  åŠ é€Ÿæ¯”: 1.97x

============================================================

âœ“ é©—è­‰å®Œæˆï¼
```

å¦‚æœçœ‹åˆ°é¡ä¼¼ä¸Šè¿°è¼¸å‡ºï¼Œè¡¨ç¤ºå®‰è£æˆåŠŸï¼

### é©—è­‰ Web æ‡‰ç”¨

å•Ÿå‹•æ‡‰ç”¨ï¼š

```bash
python run.py
```

**é æœŸè¼¸å‡ºï¼š**

```
============================================================
PaddleOCR-VL Web Application
============================================================
ä¸»æ©Ÿ: 0.0.0.0
åŸ è™Ÿ: 8000
é™¤éŒ¯æ¨¡å¼: True
============================================================

ğŸŒ æ‡‰ç”¨ç¶²å€: http://localhost:8000
ğŸ“– éƒ¨ç½²æŒ‡å—: http://localhost:8000/guide
ğŸ“Š API æ–‡ä»¶: http://localhost:8000/docs
ğŸ” ç³»çµ±ç‹€æ…‹: http://localhost:8000/api/status

æŒ‰ Ctrl+C åœæ­¢ä¼ºæœå™¨

============================================================
INFO:     Will watch for changes in these directories: ['/path/to/PaddleOCR-VL']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [12345] using StatReload
============================================================
  PaddleOCR-VL Web Application å•Ÿå‹•ä¸­...
  ç‰ˆæœ¬: 1.0.0
============================================================
âœ“ OCR æœå‹™å·²åˆå§‹åŒ– (èªè¨€: en, GPU: True)
âœ“ Gemini API å·²å°±ç·’ (æ¨¡å‹: gemini-2.0-flash-exp)
============================================================
âœ“ æ‡‰ç”¨å•Ÿå‹•å®Œæˆ
============================================================
```

é–‹å•Ÿç€è¦½å™¨è¨ªå•ï¼š

- **ä¸»æ‡‰ç”¨**ï¼šhttp://localhost:8000
- **éƒ¨ç½²æŒ‡å—**ï¼šhttp://localhost:8000/guide
- **API æ–‡ä»¶**ï¼šhttp://localhost:8000/docs
- **ç³»çµ±ç‹€æ…‹**ï¼šhttp://localhost:8000/api/status

---

## å¸¸è¦‹å•é¡Œ

### Q1: å®‰è£ PaddlePaddle æ™‚å‡ºç¾éŒ¯èª¤

**A1:** ç¢ºä¿æ‚¨ä½¿ç”¨çš„æ˜¯ Python 3.12ï¼Œä¸¦ä¸” Conda ç’°å¢ƒå·²æ­£ç¢ºå•Ÿç”¨ï¼š

```bash
# æª¢æŸ¥ Python ç‰ˆæœ¬
python --version  # æ‡‰é¡¯ç¤º Python 3.12.x

# ç¢ºèªåœ¨æ­£ç¢ºçš„ç’°å¢ƒ
conda info --envs  # paddle-ocr æ‡‰è©²æœ‰æ˜Ÿè™Ÿæ¨™è¨˜

# é‡æ–°å®‰è£
pip install --upgrade pip
pip install paddlepaddle --no-cache-dir
```

### Q2: PaddleOCR ä¸‹è¼‰æ¨¡å‹å¤±æ•—

**A2:** é¦–æ¬¡åŸ·è¡Œ OCR æ™‚ï¼ŒPaddleOCR æœƒè‡ªå‹•ä¸‹è¼‰æ¨¡å‹ã€‚å¦‚æœä¸‹è¼‰å¤±æ•—ï¼š

1. æª¢æŸ¥ç¶²è·¯é€£ç·š
2. å˜—è©¦ä½¿ç”¨ VPNï¼ˆæŸäº›åœ°å€å¯èƒ½éœ€è¦ï¼‰
3. æ‰‹å‹•ä¸‹è¼‰æ¨¡å‹ï¼š

```bash
# å‰å¾€ PaddleOCR æ¨¡å‹åº«
# https://github.com/PaddlePaddle/PaddleOCR/blob/main/doc/doc_ch/models_list.md

# ä¸‹è¼‰å¾Œæ”¾ç½®æ–¼ ~/.paddleocr/ ç›®éŒ„
```

### Q3: Gemini API å›æ‡‰ 403 éŒ¯èª¤

**A3:** 

1. æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢ºè¨­å®š
2. ç¢ºèª API Key æœªéæœŸ
3. æª¢æŸ¥ API é…é¡æ˜¯å¦å·²ç”¨ç›¡
4. è¨ªå• Google AI Studio ç¢ºèª API ç‹€æ…‹

### Q4: åœ¨ Intel Mac ä¸Šèƒ½å¦ä½¿ç”¨ï¼Ÿ

**A4:** å¯ä»¥ï¼ä½† MPS åŠ é€Ÿåƒ…é©ç”¨æ–¼ Apple Siliconã€‚åœ¨ Intel Mac ä¸Šï¼š

1. å°‡ `.env` ä¸­çš„ `USE_GPU` è¨­ç‚º `False`
2. è™•ç†é€Ÿåº¦æœƒè¼ƒæ…¢ï¼ˆä½¿ç”¨ CPUï¼‰
3. å…¶ä»–åŠŸèƒ½å®Œå…¨ç›¸åŒ

### Q5: å¦‚ä½•æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ï¼Ÿ

**A5:**

```bash
# æ‹‰å–æœ€æ–°ç¨‹å¼ç¢¼
git pull origin main

# æ›´æ–°ä¾è³´
conda activate paddle-ocr
pip install -r requirements.txt --upgrade

# é‡æ–°å•Ÿå‹•æ‡‰ç”¨
python run.py
```

### Q6: æ‡‰ç”¨ç„¡æ³•å•Ÿå‹•ï¼Œé¡¯ç¤ºåŸ è™Ÿå·²è¢«ä½”ç”¨

**A6:** 8000 åŸ è¢«å…¶ä»–ç¨‹å¼ä½”ç”¨ã€‚è§£æ±ºæ–¹æ³•ï¼š

æ–¹æ³• 1ï¼šä¿®æ”¹ `.env` æª”æ¡ˆä¸­çš„ `PORT`

```ini
PORT=8001  # æ”¹ç‚ºå…¶ä»–åŸ è™Ÿ
```

æ–¹æ³• 2ï¼šçµ‚æ­¢ä½”ç”¨ 8000 åŸ çš„ç¨‹å¼

```bash
# æ‰¾å‡ºä½”ç”¨çš„ç¨‹å¼
lsof -i :8000

# çµ‚æ­¢è©²ç¨‹å¼ï¼ˆæ›¿æ› PIDï¼‰
kill -9 <PID>
```

### Q7: ä¸Šå‚³å¤§å‹ PDF æ™‚å‡ºç¾éŒ¯èª¤

**A7:** 

1. æª¢æŸ¥æª”æ¡ˆå¤§å°æ˜¯å¦è¶…é 50MB é™åˆ¶
2. ä¿®æ”¹ `.env` ä¸­çš„ `MAX_UPLOAD_SIZE`ï¼ˆå–®ä½ï¼šä½å…ƒçµ„ï¼‰
3. å¤§å‹ PDF å¯èƒ½éœ€è¦æ›´å¤šè¨˜æ†¶é«”

### Q8: OCR è¾¨è­˜çµæœä¸æº–ç¢º

**A8:** æ”¹å–„æº–ç¢ºåº¦çš„æ–¹æ³•ï¼š

1. ç¢ºä¿é¸æ“‡æ­£ç¢ºçš„èªè¨€
2. å•Ÿç”¨ã€Œä½¿ç”¨è§’åº¦åˆ†é¡ã€
3. æé«˜æƒæ/ç…§ç‰‡çš„è§£æåº¦ï¼ˆå»ºè­° 300 DPI ä»¥ä¸Šï¼‰
4. ç¢ºä¿åœ–åƒæ¸…æ™°ï¼Œç„¡æ¨¡ç³Šæˆ–æ‰­æ›²

---

## éœ€è¦å”åŠ©ï¼Ÿ

å¦‚æœæ‚¨é‡åˆ°å…¶ä»–å•é¡Œï¼š

1. æŸ¥çœ‹ [GitHub Issues](https://github.com/yourusername/PaddleOCR-VL/issues)
2. åœ¨ [Discussions](https://github.com/yourusername/PaddleOCR-VL/discussions) æå•
3. æŸ¥é–± [PaddleOCR å®˜æ–¹æ–‡ä»¶](https://github.com/PaddlePaddle/PaddleOCR/tree/main/doc)

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰

